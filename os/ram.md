# 程序运行时内存布局

```bash
#高地址，由高到低如下
内核空间
栈区 
堆区
静态区
常量区
代码区
保留区 
#低地址
```

## 内核空间  
## 栈区 
存放什么：  
局部变量（非静态）、函数参数、函数调用时的返回地址、保存的上下文信息（如寄存器值）  
特点：  
自动管理：由编译器自动分配和释放。函数调用时入栈，函数返回时出栈。  
生命周期短暂：与函数调用周期一致。
空间有限（通常几 MB）。如果递归过深或局部变量太大，会导致 栈溢出。  
分配速度快：只是一条指令移动栈顶指针。  
地址增长方向：**从高地址向低地址增长**（与堆相反，***两者相向增长***）。  
## 堆区：  
在 C 语言中通过 malloc, calloc, realloc 申请；在 C++ 中使用 new 操作符申请。  
程序员手动管理：需要程序员自己申请，并在使用完毕后手动释放（free 或 delete），否则会导致内存泄漏。  
空间巨大：理论上受限于系统可用的虚拟内存大小，远大于栈。  
分配速度较慢：涉及更复杂的内存管理算法。  
地址增长方向：**从低地址向高地址增长** 
生命周期由程序员决定，可以从一次函数调用持续到程序结束。  

## 静态区：  
extern 全局变量、 static 静态变量（包括全局静态变量和函数内部的静态局部变量）
通常又细分为：  
.data 段：存放**已初始化**的全局/静态变量。  
.bss 段：存放**未初始化**（或初始化为0）的全局/静态变量。系统会在启动时将其清零。

## 常量区： 
字符串常量和用 const 声明的全局/静态常量

## 代码区  
编译后的机器指令（即程序的可执行代码）。这部分是只读的  

## 保留区   
通常指内存中低地址部分的一个禁区（例如靠近 0 的地址）。  
作用：用于捕捉对 NULL 指针的访问。任何尝试读写此区域的操作都会被操作系统阻止并引发崩溃，这帮助程序员快速发现空指针解引用错误。